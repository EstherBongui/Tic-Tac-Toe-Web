<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" integrity="sha512-Avb2QiuDEEvB4bZJYdft2mNjVShBftLdPG8FJ0V7irTLQ8Uo0qcPxh4Plq7G5tGm0rU+1SPhVotteLpBERwTkw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="jeu.css">
    <title>Resultats</title>
</head>
<body>
    <div class="container">
    <div class="card">
        <h5 class="card-header">Partie En Cours</h5>
        <div class="card-body">
          <form action="InfoJoueur.html" method="post">
            <div id="message"></div>
            <table class="table">
              <thead>
                  <tr>
                      <th>Jeu</th>
                      <th>Joueur</th>
                      <th>Difficulté</th>
                      <th>Résultat</th>
                  </tr>
              </thead>
              <tbody id="resultatsTable">

              </tbody>
          </table>
            <input type="submit" value="Recommencer" >
            
          </form>
        </div>
      </div>
    </div>
      <script>
        function sauvegardeResultat() {
            var resultatsExistants = JSON.parse(localStorage.getItem('resultats')) || [];
            var sexe = localStorage.getItem('sexe');
            var nom = localStorage.getItem('nom');
            var prenom = localStorage.getItem('prenom');
            var difficulte = localStorage.getItem('difficulte');
            var resultat = localStorage.getItem('resultat');
            
            resultatsExistants.push({
                jeu: resultatsExistants.length + 1,
                joueur: `${nom} ${prenom}`,
                difficulte: difficulte,
                resultat: resultat
            });
            
            localStorage.setItem('resultats', JSON.stringify(resultatsExistants));
        }

        function afficheResultats() {
            var resultats = JSON.parse(localStorage.getItem('resultats')) || [];
            var tableBody = document.getElementById('resultatsTable');
            tableBody.innerHTML = resultats.map(res => `
                <tr>
                    <td>${res.jeu}</td>
                    <td>${res.joueur}</td>
                    <td>${res.difficulte}</td>
                    <td>${res.resultat}</td>
                </tr>
            `).join('');
        }

        window.onload = function() {
            sauvegardeResultat();
            afficheResultats();
            
            var sexe = localStorage.getItem('sexe');
            var nom = localStorage.getItem('nom');
            var prenom = localStorage.getItem('prenom');
            var resultat = localStorage.getItem('resultat');
            var message = "";

            if (resultat === 'gagne') {
                message = "vous avez gagné la partie";
            } else if (resultat === 'perdu') {
                message = "vous avez perdu la partie";
            } else {
                message = "la partie s'est terminée par un match nul";
            }
              
            if (sexe === 'homme') {
                message = "Mr " + nom + " " + prenom + ", " + message;
            } else if (sexe === 'femme') {
                message = "Mme " + nom + " " + prenom + ", " + message;
            }
            
            document.getElementById('message').innerText = message;
        };
    </script>
</body>
</html>